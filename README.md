### General description
Репозиторий включает два сервиса:
1. Обработка новостей.
2. Создание/ обновление результирующей таблицы.

Пайплайн обработки новостей состоит из следующих этапов:
1. Делаем запрос в базу на наличие уже обработанных новостей.
2. С даты, следующей за последней датой (dates) новостей в 
таблице trade_news_events, собиремя новости за один день, за исключением уже обработанных новостей.
3. Если последняя дата более чем 7 дней от сегодняшней даты запуска сервиса, 
то шаг обработки новостей принимается равным 2, если более 7 то шаг 1.
4. С заданным шагом идем по найденным необработанным новостям. Для каждой новости:
  </br>4.1. Определяем язык новости, если не русский или английский, то новость пропускаем.
  </br>4.2. Делаем классификацию по типу отношений
  </br>4.3. Для торговых новостей определяем сущности и отношения.
  </br>4.4. Для сущностей PRODUCT делаем классификацию по СМТК.
  </br>4.5. Если в найденных товарах нет класса "93" по СМТК, 
    то делаем классификацию отдельной моделью по отношению к классу "93".
5. Всю информацию записываем в базу данных.
6. Если дата старта соответствует дате сегодня, то новости собираются каждый час.

Пайплайн обновления таблицы состоит из следующих этапов:
1. Удаляется существующая таблица trade_news_events и материализованные представления.
2. Создаются материализованные представления и новая таблица trade_news_events.
3. Данные из мат. представлений фильтруются и записываются в таблицу trade_news_events.
Обновление происходит раз в сутки в 02:00 UCT.


Все модели хранятся на minio (`http://10.8.0.2:9000/minio/models/`)
Для запуска сервиса необходимо, чтобы в этот момент уже работал сервис с моделями 
(репо http://10.8.0.4:3050/trade-news/trade_news_models) и были прописаны переменные окружения:
```python
POSTGRES_USER=
POSTGRES_PASSWORD=
POSTGRES_HOST=
POSTGRES_PORT=
POSTGRES_DB=
TG_TOKEN=
NER_SERVER=
RE_SERVER=
CLF_NEWS_SERVER=
WORD_PROD_CLF_SERVER=
TEXT_SPEC_PROD_CLF_SERVER=
LANG_SERVER=
MODELS_NAMES=
START_DATE=
LATE_STEP=
```
LATE_STEP - шаг обработки новостей, если есть задержка между текущей датой и последней датой в базе. 
Неоюходимо указывать, чтобы ускорить обработку новостей за предыдущие дни.


